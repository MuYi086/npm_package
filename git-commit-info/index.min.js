const{execSync:t}=require("child_process"),e=e=>{try{return t(e,{encoding:"utf8"}).trim()}catch(t){return new Error("执行git命令失败")}},m=()=>e("git symbolic-ref --short -q HEAD"),r=()=>e("git config user.name"),i=()=>e("git config user.email"),c=()=>{const t=e("git show-ref --tags");let m=[];return t&&"string"==typeof t&&(m=t.match(/refs\/tags\/.+/gi)),m},o=(t=[])=>{if(t&&t.length>0){return t[t.length-1].replace("refs/tags/","")}return""},a=()=>{let t="";const m=e("git remote -v");if(m&&m.includes("push")){t=m.match(/\/.*\.git/g)[1].replace("/","").replace(".git","")}return t},g=()=>({commitName:e("git log -1 --pretty=format:%cn"),commitEmail:e("git log -1 --pretty=format:%ce"),commitDate:e("git log -1 --pretty=format:%ci"),commitSubject:e("git log -1 --pretty=format:%s"),commitHash:e("git log -1 --pretty=format:%H")}),s=()=>{const t=a(),e=m(),s=r(),n=i(),{commitName:l,commitEmail:u,commitDate:f,commitSubject:h,commitHash:p}=g(),y=c();return{projectName:t,branch:e,gitUserName:s,gitUserEmail:n,commitName:l,commitEmail:u,commitDate:f,commitSubject:h,commitHash:p,latestTag:o(y)}};module.exports=s;