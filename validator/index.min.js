class Validator{constructor(){this.typeArr=["phone","telPhone","email","password","dateTime","identityCard","website","taxnum","isNum","isImg","isVideo","isAudio","isLetter","isNumLetter","isHanzi","default"],this.typeKeyValue=[{key:"phone",value:"手机号"},{key:"telPhone",value:"座机号"},{key:"email",value:"邮箱"},{key:"password",value:"密码"},{key:"dateTime",value:"日期"},{key:"identityCard",value:"身份证号"},{key:"website",value:"网址"},{key:"taxnum",value:"税号"},{key:"isNum",value:"数字"},{key:"isImg",value:"图片"},{key:"isVideo",value:"视频"},{key:"isAudio",value:"音频"},{key:"isLetter",value:"字母"},{key:"isNumLetter",value:"数字字母"},{key:"isHanzi",value:"汉字"}]}verify(e,a="default",t){let m="",s=1;const l=this.parseKeyValue(a);switch(a){case"phone":e?/^1(3|4|5|6|7|8|9)\d{9}$/g.test(e)?!t||e.length<=t?(s=1,m=""):(s=0,m=this.autoComplementLabelName(l,4,t)):(s=0,m=this.autoComplementLabelName(l,2)):(s=0,m=this.autoComplementLabelName(l,1));break;case"telPhone":e?/^0\d{2,3}-?\d{7,8}$/g.test(e)?!t||e.length<=t?(s=1,m=""):(s=0,m=this.autoComplementLabelName(l,4,t)):(s=0,m=this.autoComplementLabelName(l,2)):(s=0,m=this.autoComplementLabelName(l,1));break;case"email":e?/^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$/g.test(e)?!t||e.length<=t?(s=1,m=""):(s=0,m=this.autoComplementLabelName(l,4,t)):(s=0,m=this.autoComplementLabelName(l,2)):(s=0,m=this.autoComplementLabelName(l,1));break;case"password":if(e){let a=0;if(/[0-9]+/g.test(e)&&a++,/[a-zA-Z]+/g.test(e)&&a++,/(!|@|#|\$|%|\^|&|\*|\(|\)|_|\+|-){1,}/g.test(e)&&a++,a>=2)!t||e.length<=t?(s=1,m=""):(s=0,m=this.autoComplementLabelName(l,4,t));else{s=0;const e="密码须包含数字,字母,特殊字符字少俩种组合";m=this.autoComplementLabelName(l,3,e)}}else s=0,m=this.autoComplementLabelName(l,1);break;case"dateTime":if(e){const a=new Date(e).getTime();isNaN(a)?(s=0,m=this.autoComplementLabelName(l,2)):(s=1,m="")}else s=0,m=this.autoComplementLabelName(l,1);break;case"identityCard":e?/^[1-9]\d{5}(18|19|20)\d{2}((0[1-9])|(1[0-2]))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/g.test(e)?(s=1,m=""):(s=0,m=this.autoComplementLabelName(l,2)):(s=0,m=this.autoComplementLabelName(l,1));break;case"website":e?/^(?:(http|https|ftp):\/\/)?((?:[\w-]+\.)+[a-z0-9]+)((?:\/[^/?#]*)+)?(\?[^#]+)?(#.+)?$/g.test(e)?(s=1,m=""):(s=0,m=this.autoComplementLabelName(l,2)):(s=0,m=this.autoComplementLabelName(l,1));break;case"taxnum":case"isNumLetter":e?/^\w{1,}$/g.test(e)?(s=1,m=""):(s=0,m=this.autoComplementLabelName(l,2)):(s=0,m=this.autoComplementLabelName(l,1));break;case"isNum":e?/^\d{1,}$/g.test(e)?(s=1,m=""):(s=0,m=this.autoComplementLabelName(l,2)):(s=0,m=this.autoComplementLabelName(l,1));break;case"isImg":e?/(jpg|jpeg|png|webp|gif|svg|bmp|JPG|JPEG|PNG|WEBP|GIF|SVG|bmp)$/g.test(e)?(s=1,m=""):(s=0,m=this.autoComplementLabelName(l,2)):(s=0,m=this.autoComplementLabelName(l,1));break;case"isVideo":e?/(wmv|asf|asx|rm|rmvb|mpg|mpeg|mpe|3gp|mov|mp4|m4v|avi|dat|mkv|flv|vob)$/g.test(e)?(s=1,m=""):(s=0,m=this.autoComplementLabelName(l,2)):(s=0,m=this.autoComplementLabelName(l,1));break;case"isAudio":e?/(mp3|wav|wma|ogg|mp2|flac|midi|ra|ape|acc|cda|mov)$/g.test(e)?(s=1,m=""):(s=0,m=this.autoComplementLabelName(l,2)):(s=0,m=this.autoComplementLabelName(l,1));break;case"isLetter":e?/^[a-zA-Z]+$/g.test(e)?(s=1,m=""):(s=0,m=this.autoComplementLabelName(l,2)):(s=0,m=this.autoComplementLabelName(l,1));break;case"isHanzi":e?/^[\u4e00-\u9fa5]+$/g.test(e)?(s=1,m=""):(s=0,m=this.autoComplementLabelName(l,2)):(s=0,m=this.autoComplementLabelName(l,1));break;default:e?(s=1,m=""):(s=0,m=this.autoComplementLabelName(l,1))}return[s,m]}autoComplementLabelName(e,a,t){return 1===a?`${e}不能为空`:2===a?`请输入正确的${e}`:3===a?t:4===a?`${e}的最大长度为${t}`:void 0}parseKeyValue(e){let a=e;return this.typeKeyValue.forEach((t=>{e===t.key&&(a=t.value)})),a}}const validator=new Validator;module.exports=validator;